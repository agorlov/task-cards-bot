"""
–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, —á—Ç–æ–±—ã –Ω–∞–ø–æ–º–Ω–∏—Ç—å –æ —Å–µ–±–µ, –∑–∞–º–æ—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–Ω–¥–æ–º–Ω—É—é —Ü–∏—Ç–∞—Ç—É –≤ 19:00 (...–Ω–µ –ø–æ –ú–°–ö)
"""
import telebot
import psycopg2
from psycopg2.extras import DictCursor
from psycopg2.extensions import ISOLATION_LEVEL_AUTOCOMMIT

import random
from datetime import datetime
import logging

from config import TOKEN, DBCONN
from middlewarebot import MiddlewareBot

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(filename='app.log',  # –£–∫–∞–∑—ã–≤–∞–µ–º —Ñ–∞–π–ª –¥–ª—è –∑–∞–ø–∏—Å–∏ –ª–æ–≥–æ–≤
                    level=logging.DEBUG,  # –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
                    format='%(asctime)s %(message)s',  # –§–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π
                    datefmt='%d/%m %H:%M:%S')  # –§–æ—Ä–º–∞—Ç –≤—Ä–µ–º–µ–Ω–∏


# TeleBot (–º–∏–¥–ª-–≤–∞—Ä–µ —É–º–µ–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å)
bot = MiddlewareBot(TOKEN)

# DB Postgres connection
db = psycopg2.connect(
    dbname=DBCONN['dbname'],
    user=DBCONN['user'],
    password=DBCONN['password'],
    host=DBCONN['host'],
    port=DBCONN['port']
)
db.set_isolation_level(ISOLATION_LEVEL_AUTOCOMMIT)


def users():
    with db.cursor(cursor_factory=DictCursor) as cursor:
        cursor.execute("SELECT * FROM users WHERE hello_failure_count < 3")
        result = cursor.fetchall()
        return result

quotes = [
    "–ü—Ä–∏–≤–µ—Ç! üëã",
    "–î–µ–ª—É –≤—Ä–µ–º—è, –ø–æ—Ç–µ—Ö–µ —á–∞—Å. ‚è∞",
    "–ü—É—Ç—å –≤ —Ç—ã—Å—è—á—É –ª–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ —à–∞–≥–∞. üö∂",
    "–ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –Ω–∞ –∑–∞–≤—Ç—Ä–∞ —Ç–æ, —á—Ç–æ –º–æ–∂–µ—à—å —Å–¥–µ–ª–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è. üåû",
    "–ù–µ –±–æ–π—Å—è –∏–¥—Ç–∏ –º–µ–¥–ª–µ–Ω–Ω–æ, –±–æ–π—Å—è —Å—Ç–æ—è—Ç—å –Ω–∞ –º–µ—Å—Ç–µ. üê¢",
    "‚Äû–ö–∞–∂–¥—ã–π –º–µ—á—Ç–∞–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –º–∏—Ä, –Ω–æ –Ω–∏–∫—Ç–æ –Ω–µ —Å—Ç–∞–≤–∏—Ç —Ü–µ–ª—å—é –∏–∑–º–µ–Ω–∏—Ç—å —Å–∞–º–æ–≥–æ —Å–µ–±—è.‚Äú ‚Äî –õ–µ–≤ –ù–∏–∫–æ–ª–∞–µ–≤–∏—á –¢–æ–ª—Å—Ç–æ–π üåç",
    "‚Äû–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ ‚Äî —ç—Ç–æ —É–º–µ–Ω–∏–µ –ø—Ä–∏–≤–æ–¥–∏—Ç—å —Å–µ–±—è –≤ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ.‚Äú ‚Äî –ê.–°. –ü—É—à–∫–∏–Ω ‚úç",
    "–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –±—É–¥—É—â–µ–µ - —Å–æ–∑–¥–∞—Ç—å –µ–≥–æ üîÆ",
    "–ù–µ –∑–∞—Ü–∏–∫–ª–∏–≤–∞–π—Ç–µ—Å—å –Ω–∞ –ø—Ä–æ—à–ª–æ–º - –≤–∞—Å —Ç–∞–º –±–æ–ª—å—à–µ –Ω–µ –±—É–¥–µ—Ç. üîô",
    "‚Äû–ò–¥–∏–æ—Ç—ã –¥–µ–ª–∞—é—Ç —Ç–æ, —á—Ç–æ –∏–º –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è. –£–º–Ω—ã–µ –ª—é–¥–∏ –¥–µ–ª–∞—é—Ç —Ç–æ, —á—Ç–æ –ª—é–±—è—Ç –¥–µ–ª–∞—Ç—å. –ì–µ–Ω–∏–∏ –º–æ–≥—É—Ç —Å —Ä–∞–¥–æ—Å—Ç—å—é –¥–µ–ª–∞—Ç—å —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ‚Äú ‚Äî –°–∞–¥—Ö–≥—É—Ä—É",
    "–ï—Å–ª–∏ –∫–∞–∂–¥—ã–º —Å–≤–æ–∏–º –¥–µ–π—Å—Ç–≤–∏–µ–º –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ —á—Ç–æ-—Ç–æ, —á—Ç–æ –¥–ª—è –≤–∞—Å –≤–∞–∂–Ω–æ, –≤–∞—à–∞ –ñ–∏–∑–Ω—å –ü—Ä–µ–∫—Ä–∞—Å–Ω–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–æ–≥–æ, –ø–æ–ª—É—á–∏—Ç–µ –≤—ã —á—Ç–æ-–Ω–∏–±—É–¥—å –æ—Ç —ç—Ç–æ–≥–æ –∏–ª–∏ –Ω–µ—Ç.‚Äú ‚Äî –°–∞–¥—Ö–≥—É—Ä—É",
    "¬´–í–µ—Ä—å –≤ –º–µ—á—Ç—É. –£ –Ω–µ—ë –µ—Å—Ç—å –ø—Ä–∏—è—Ç–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å ‚Äî —Å–±—ã–≤–∞—Ç—å—Å—è¬ª. ‚Äî –í–∏—Ç–∞–ª–∏–π –ì–∏–±–µ—Ä—Ç.",
    "‚Äû–ù–∞—á–∏–Ω–∞–π —Å –º–∞–ª–æ–≥–æ, –Ω–æ –º–µ—á—Ç–∞–π –æ –≤–µ–ª–∏–∫–æ–º. –ù–µ –∑–∞–Ω–∏–º–∞–π—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–∏–º–∏ –≤–µ—â–∞–º–∏. –ó–∞–π–º–∏—Å—å —Å–Ω–∞—á–∞–ª–∞ –Ω–µ–º–Ω–æ–≥–∏–º–∏ –ø—Ä–æ—Å—Ç—ã–º–∏ –¥–µ–ª–∞–º–∏, –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º. –ò –≤—Å–µ–≥–¥–∞ –¥—É–º–∞–π –æ –±—É–¥—É—â–µ–º.‚Äú ‚Äî  –°—Ç–∏–≤ –î–∂–æ–±—Å",
    "–°–æ–≤–µ—Ç –±–æ—Ç–∞: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –ø—Ä–∏–¥—É–º–∞–ª –∏–ª–∏ —É–≤–∏–¥–µ–ª –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å, –∑–∞–ø–∏—à–∏ —Å—Ä–∞–∑—É —ç—Ç–æ –≤ –≤–∏–¥–µ –¥–µ–ª–∞. –ü—É—Å—Ç—å –º—ã—Å–ª—å –ø–æ–ª–µ–∂–∏—Ç –∏ **–Ω–µ –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –≥–æ–ª–æ–≤—É**, –ø—Ä–∏–¥–µ—Ç –≤—Ä–µ–º—è –∏ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –µ–π –∑–∞–Ω—è—Ç—å—Å—è.",
    """
    –í—ã–≥—Ä—É–∑–∫–∞ –∏–∑ –≥–æ–ª–æ–≤—ãüß†
    –ó–∞–¥–∞—á–∞ –æ–¥–Ω–∞ - –≤—ã–ª–∏—Ç—å –Ω–∞ –±—É–º–∞–≥—É –∏–ª–∏ –≤ –∑–∞–º–µ—Ç–∫–∏ –≤—Å–µ –¥–µ–ª–∞, —á—Ç–æ —Ä–æ—è—Ç—Å—è –≤ –≥–æ–ª–æ–≤–µ.üêù
    –û–Ω–∏ —Ç—è–Ω—É—Ç –Ω–∞—à—É —ç–Ω–µ—Ä–≥–∏—é –∏ –∑–∞–±–∏–≤–∞—é—Ç –Ω–∞—à—É "–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å": —Å–¥–µ–ª–∞—Ç—å, –∫—É–ø–∏—Ç—å, –æ–ø–ª–∞—Ç–∏—Ç—å, –≤–µ—Ä–Ω—É—Ç—å, –Ω–∞–π—Ç–∏... ü§Ø
    """,
    "–°–æ–≤–µ—Ç –±–æ—Ç–∞: –µ—Å–ª–∏ –∑–∞–¥–∞—á–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å —Å–ª–æ–∂–Ω–æ–π –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–π, —Å–æ–≤–µ—Ç—É—é —Å–¥–µ–ª–∞—Ç—å —á–∞—Å—Ç—å, –∑–∞–≤–µ—Ä—à–∏—Ç—å –∏ —Å–æ–∑–¥–∞–π –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –≤ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π.",
    "–°–æ–≤–µ—Ç –±–æ—Ç–∞: –¥–µ–ª–∞–π –∑–¥–∞—á–∏ –Ω–µ–±–æ–ª—å—à–∏–º–∏ –∏–ª–∏ —Ä–∞–∑–±–∏–≤–∞–π –∏—Ö –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏, —Ç–∞–∫ –±—É–¥–µ—Ç –ø—Ä–∏—è—Ç–Ω–µ–µ –∏—Ö –∑–∞–≤–µ—Ä—à–∞—Ç—å –∏ –±–æ–ª—å—à–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å",
    "–°–æ–≤–µ—Ç –±–æ—Ç–∞: ¬´–°—ä–µ—Å—Ç—å —Å–ª–æ–Ω–∞ –ø–æ —á–∞—Å—Ç—è–º¬ª. –î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —ç—Ç–æ –∫–æ–≥–¥–∞ –∫—Ä—É–ø–Ω–∞—è –∑–∞–¥–∞—á–∞ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ —á–∞—Å—Ç–∏.",
    "–°–æ–≤–µ—Ç, –∫–∞–∫ —Å–Ω—è—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ: –ì–ª—É–±–∫–æ–µ –¥—ã—Ö–∞–Ω–∏–µ - –≤–¥–æ—Ö–Ω–∏ –≥–ª—É–±–æ–∫–æ —á–µ—Ä–µ–∑ –Ω–æ—Å –≤ –∂–∏–≤–æ—Ç, –∑–∞—Ç–µ–º –≥—Ä—É–¥—å –Ω–∞ —Å—á–µ—Ç 1-2-3-4. –í—ã–¥—ã—Ö–∞–π—Ç–µ –º–µ–¥–ª–µ–Ω–Ω–æ, —Å–≤–∏—Å—Ç—è —á–µ—Ä–µ–∑ –≥—É–±—ã, —Å—á–∏—Ç–∞—è –¥–æ 4. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ 3-4 —Ä–∞–∑–∞.",
    "–ö–∞–∫ –æ—Ç–¥—ã—Ö–∞—Ç—å –º–µ–∂–¥—É –¥–µ–ª–∞–º–∏ –Ω–∞ —Ä–∞–±–æ—Ç–µ: –ø–æ–æ–±—â–∞—Ç—å—Å—è —Å –∫–æ–ª–ª–µ–≥–∞–º–∏, –≤—ã–ø–∏—Ç—å —á–∞–π, –Ω–µ–º–Ω–æ–≥–æ –ø—Ä–æ–π—Ç–∏—Å—å, –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –æ–∫–Ω–æ, –ø–æ–¥—ã—à–∞—Ç—å –≥–ª—É–±–æ–∫–æ, –≤—ã–ø–∏—Ç—å –≤–æ–¥—ã, –ø–æ—Å–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É",
    "–õ–µ–≥–∫–æ—Å—Ç—å –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —É—Å–∏–ª–∏–π, –∞ –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è. ‚Äî –î–∏–ø–∞–∫ –ß–æ–ø—Ä–∞",
    "–ï—Å—Ç—å —Ç—Ä–∏ –ª–æ–≤—É—à–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ—Ä—É—é—Ç —Ä–∞–¥–æ—Å—Ç—å –∏ –º–∏—Ä: —Å–æ–∂–∞–ª–µ–Ω–∏–µ –æ –ø—Ä–æ—à–ª–æ–º, —Ç—Ä–µ–≤–æ–≥–∞ –∑–∞ –±—É–¥—É—â–µ–µ –∏ –Ω–µ–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å –∑–∞ –Ω–∞—Å—Ç–æ—è—â–µ–µ.",
    "–ù–∞ –ê–ª–ª–∞—Ö–∞ –Ω–∞–¥–µ–π—Å—è, –∞ –≤–µ—Ä–±–ª—é–¥–∞ –ø—Ä–∏–≤—è–∑—ã–≤–∞–π. ‚Äî –ø–æ–≥–æ–≤–æ—Ä–∫–∞ —Å –≤–æ—Å—Ç–æ–∫–∞",
    "–ö–æ–≥–¥–∞ —á–µ–ª–æ–≤–µ–∫ —Å—á–∞—Å—Ç–ª–∏–≤, –æ–Ω —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω –∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç –µ–≥–æ —à–∞–Ω—Å—ã –Ω–∞ —É—Å–ø–µ—Ö.",
    "–ü–∞—Ä–∞–¥–æ–∫—Å:\n - –∏—â–µ—à—å —Å—á–∞—Å—Ç—å–µ, –±–æ–ª—å—à–µ —à–∞–Ω—Å–æ–≤ –¥–æ—Å—Ç–∏—á—å —É—Å–ø–µ—Ö–∞.\n - –ø—Ä–µ—Å–ª–µ–¥—É—à—å —É—Å–ø–µ—Ö, –º–µ–Ω—å—à–µ —à–∞–Ω—Å–æ–≤ –Ω–∞ —É—Å–ø–µ—Ö –∏ —Å—á–∞—Å—Ç—å–µ.",
    "¬´–ï—Å–ª–∏ –≤—ã –Ω–µ –¥–µ–ª–∞–µ—Ç–µ —Ç–æ–≥–æ, —á—Ç–æ –Ω–µ –º–æ–∂–µ—Ç–µ, ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞. –ù–æ –µ—Å–ª–∏ –≤—ã –Ω–µ –¥–µ–ª–∞–µ—Ç–µ —Ç–æ–≥–æ, —á—Ç–æ —Å–¥–µ–ª–∞—Ç—å –º–æ–∂–µ—Ç–µ, –≤–∞—à–∞ –∂–∏–∑–Ω—å ‚Äì –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∞¬ª. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É",
    "–í—ã –¥–æ—Å—Ç–∏–≥–∞–µ—Ç–µ —á–µ–≥–æ-—Ç–æ –Ω–µ –ø–æ—Ç–æ–º—É, —á—Ç–æ —ç—Ç–æ–≥–æ –∂–µ–ª–∞–µ—Ç–µ, –∞ –ø–æ—Ç–æ–º—É, —á—Ç–æ –¥–µ–ª–∞–µ—Ç–µ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –í–µ—â–∏ –∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É",
    "¬´–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ –Ω–µ –æ–∑–Ω–∞—á–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å. –≠—Ç–æ —Ä–∞–∑—É–º–Ω–æ—Å—Ç—å, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –¥–µ–ª–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ¬ª. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É",
    "–ï—Å–ª–∏ –µ—Å—Ç—å —Å—Ç—Ä–µ–º–ª–µ–Ω–∏–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ –≤—ã—Å—Ç—Ä–æ–∏—Ç—Å—è —Å–∞–º–æ —Å–æ–±–æ–π. –†–∞–π –∏ –∞–¥ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ –≤–∞—Å. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É",
    "–î–µ–ª–æ –Ω–µ –≤ —Ç–æ–º —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ, –∞ –≤ —Ç–æ–º —á—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ —ç—Ç–æ –Ω–µ —Å–≤–æ—Ä–∞—á–∏–≤–∞—è —Å –ø—É—Ç–∏. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É",
    """
    –ß–µ–º –±—ã –≤—ã –Ω–∏ —Ö–æ—Ç–µ–ª–∏ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –≤ –∂–∏–∑–Ω–∏, –≤—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–≤–µ—Å—Ç–∏ —Å–µ–±—è
    –∫ –º–æ–º–µ–Ω—Ç—É —Ä–∞–¥–æ—Å—Ç–∏ –∏ —è—Å–Ω–æ—Å—Ç–∏ –≤–Ω—É—Ç—Ä–∏. –ò —á—Ç–æ–±—ã –≤—ã –Ω–∏ —Ä–µ—à–∏–ª–∏ –≤ —ç—Ç–æ—Ç 
    –º–æ–º–µ–Ω—Ç, –≤—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —ç—Ç–æ–≥–æ. ‚Äì –°–∞–¥—Ö–≥—É—Ä—É
    """,
    "¬´–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äì –º–∞—Ç—å –ª—é–±–æ–π –ø–æ–±–µ–¥—ã.¬ª ‚Äì –ê.–í. –°—É–≤–æ—Ä–æ–≤"
]

for user in users():
    quote = random.choice(quotes)

    #msg = f"–ü—Ä–∏–≤–µ—Ç ‚ú®, –¥–ª—è –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è:\n{quote}"
    msg = f"{quote}"
    try:
        message = bot.send_message(user['telegram_id'], msg)
        res = f"{msg}\n OK! ID: {message.message_id}"
    except telebot.apihelper.ApiException as e:
        res = f"{msg}\n –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: {e}"
        with db.cursor() as cursor:
            cursor.execute(
                """
                UPDATE users 
                SET hello_failure_count = hello_failure_count + 1, hello_failure_date = %s 
                WHERE telegram_id = %s
                """,
                (datetime.now(), user['telegram_id'])
            )
    
    logging.info(res)
